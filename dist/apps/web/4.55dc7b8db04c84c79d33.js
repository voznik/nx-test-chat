(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{MEpA:function(e,t,n){"use strict";n.r(t),n.d(t,"ChatWrapperModule",(function(){return K}));var s=n("2kYt"),c=n("DLXF"),r=n("sEIs"),a=n("EM62"),i=n("Meci"),o=n("29Wa"),u=n("Cd2c"),l=n("nIj0"),b=n("PBFl"),m=n("Jb3d"),d=n("kAAd"),h=n("bFHC");function p(e,t){if(1&e){const e=a.Qb();a.Pb(0,"mat-grid-tile",10),a.Xb("click",(function(){a.lc(e);const n=t.$implicit;return a.Zb().onSmileClick(n)})),a.uc(1),a.Ob()}if(2&e){const e=t.$implicit;a.zb(1),a.vc(e)}}const g=function(){return{standalone:!0}};let f=(()=>{class e{constructor(){this.smiles=["\ud83d\ude42","\ud83d\ude43","\ud83d\ude02","\ud83d\ude19"],this.send=new a.n}onSmileClick(e){this.text=this.text+e}onSubmit(e){e.valid&&e.value.length&&e.value.length>=3&&(this.send.emit(e.value.trim()),e.reset())}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Eb({type:e,selectors:[["chat-form"]],inputs:{text:"text"},outputs:{send:"send"},decls:16,vars:6,consts:[["layout","row","layout-align","start center"],["flex","","layout","row","floatLabel","never","appearance","outline","hideRequiredMarker","true",1,"push-left","push-right"],["rows","1","flex","","matInput","","placeholder","Type your message, and hit Enter","name","text","minlength","3",3,"ngModel","ngModelOptions","ngModelChange","keydown.enter"],["t","ngModel"],["mat-button","","matTooltip","Add content","matTooltipPosition","after",3,"matMenuTriggerFor"],["chatMenu","matMenu"],["cols","2","rowHeight","2:1"],[3,"click",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Send","matTooltipPosition","after","type","submit",3,"disabled","click"],["matSuffix",""],[3,"click"]],template:function(e,t){if(1&e){const e=a.Qb();a.Pb(0,"mat-card"),a.Pb(1,"div",0),a.Pb(2,"mat-form-field",1),a.Pb(3,"textarea",2,3),a.Xb("ngModelChange",(function(e){return t.text=e}))("keydown.enter",(function(){a.lc(e);const n=a.jc(4);return t.onSubmit(n)})),a.Ob(),a.Ob(),a.Pb(5,"div"),a.Pb(6,"button",4),a.uc(7," \ud83d\ude42 "),a.Ob(),a.Pb(8,"mat-menu",null,5),a.Pb(10,"mat-grid-list",6),a.tc(11,p,2,1,"mat-grid-tile",7),a.Ob(),a.Ob(),a.Ob(),a.Pb(12,"div"),a.Pb(13,"button",8),a.Xb("click",(function(){a.lc(e);const n=a.jc(4);return t.onSubmit(n)})),a.Pb(14,"mat-icon",9),a.uc(15,"send"),a.Ob(),a.Ob(),a.Ob(),a.Ob(),a.Ob()}if(2&e){const e=a.jc(4),n=a.jc(9);a.zb(3),a.fc("ngModel",t.text)("ngModelOptions",a.hc(5,g)),a.zb(3),a.fc("matMenuTriggerFor",n),a.zb(5),a.fc("ngForOf",t.smiles),a.zb(2),a.fc("disabled",e.pristine||e.invalid)}},directives:[i.a,o.a,u.a,l.a,l.d,l.g,l.j,b.a,m.b,m.c,d.a,s.l,h.a,o.e,d.c],styles:[".mat-form-field-wrapper{padding-bottom:.25rem}"],encapsulation:2,changeDetection:0}),e})();var v=n("nKqi"),O=n("mFH5");function P(e,t){if(1&e&&(a.Pb(0,"mat-list-item",3),a.Lb(1,"img",4),a.Pb(2,"h3",5),a.uc(3),a.Pb(4,"span",6),a.uc(5),a.ac(6,"date"),a.Ob(),a.Ob(),a.Pb(7,"div",7),a.Pb(8,"div",8),a.uc(9),a.Ob(),a.Ob(),a.Ob()),2&e){const e=t.$implicit;a.Cb("border-bottom",!t.last),a.zb(1),a.gc("src","https://api.adorable.io/avatars/285/",e.user.id||0,"@adorable.io.png",a.mc),a.zb(2),a.wc(" ",e.user.name||"Firstname Lastname"," "),a.zb(2),a.vc(a.cc(6,6,e.date,"shortTime")),a.zb(4),a.wc(" ",e.message," ")}}function w(e,t){1&e&&(a.Pb(0,"mat-list-item"),a.Pb(1,"div",8),a.uc(2," There's no messaged in this chat room "),a.Ob(),a.Ob())}let S=(()=>{class e{constructor(){this.messages=null}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Eb({type:e,selectors:[["chat-list"]],inputs:{messages:"messages"},decls:5,vars:2,consts:[["flex","",1,"mat-content"],["class","pad-top pad-bottom",3,"border-bottom",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"pad-top","pad-bottom"],["matListAvatar","",3,"src"],["matLine","",1,"cursor-pointer","tc-grey-700"],[1,"tc-grey-500","md-caption"],["matLine",""],[1,"text-wrap"]],template:function(e,t){1&e&&(a.Pb(0,"div",0),a.Pb(1,"mat-card"),a.Pb(2,"mat-list"),a.tc(3,P,10,9,"mat-list-item",1),a.tc(4,w,3,0,"mat-list-item",2),a.Ob(),a.Ob(),a.Ob()),2&e&&(a.zb(3),a.fc("ngForOf",t.messages),a.zb(1),a.fc("ngIf",!t.messages||!t.messages.length))},directives:[i.a,v.a,s.l,s.m,v.d,v.b,O.d],pipes:[s.e],styles:[""],encapsulation:2,changeDetection:0}),e})();function y(e,t){if(1&e){const e=a.Qb();a.Pb(0,"a",4),a.Xb("dblclick",(function(t){a.lc(e);const n=a.Zb().$implicit;return a.Zb().onUserClick(t,n)})),a.Pb(1,"mat-icon",5),a.uc(2,"lens"),a.Ob(),a.Pb(3,"span",6),a.Lb(4,"img",7),a.uc(5),a.Ob(),a.Ob()}if(2&e){const e=a.Zb().$implicit;a.zb(4),a.gc("src","https://api.adorable.io/avatars/285/",e.id||0,"@adorable.io.png",a.mc),a.zb(1),a.wc(" ",e.name,"")}}function k(e,t){if(1&e&&(a.Nb(0),a.tc(1,y,6,2,"a",3),a.Mb()),2&e){const e=t.$implicit,n=a.Zb();a.zb(1),a.fc("ngIf",(null==n.currentUser?null:n.currentUser.name)!==e.name)}}function I(e,t){1&e&&(a.Pb(0,"a",8),a.uc(1,"There'se no one exept you in this chat room"),a.Ob())}n("ZTXN");let M=(()=>{class e{constructor(){this.users=[],this.userClicked=new a.n}ngOnInit(){}onUserClick(e,t){e.preventDefault(),this.userClicked.emit(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Eb({type:e,selectors:[["chat-users"]],inputs:{currentUser:"currentUser",users:"users"},outputs:{userClicked:"userClicked"},decls:3,vars:2,consts:[["dense",""],[4,"ngFor","ngForOf"],["mat-list-item","",4,"ngIf"],["mat-list-item","",3,"dblclick",4,"ngIf"],["mat-list-item","",3,"dblclick"],["color","accent","matListIcon",""],["layout","row","layout-align","start center"],[1,"size-16","push-right-sm",3,"src"],["mat-list-item",""]],template:function(e,t){1&e&&(a.Pb(0,"mat-list",0),a.tc(1,k,2,1,"ng-container",1),a.tc(2,I,2,0,"a",2),a.Ob()),2&e&&(a.zb(1),a.fc("ngForOf",t.users),a.zb(1),a.fc("ngIf",!t.users||1===t.users.length&&(null==t.currentUser?null:t.currentUser.name)===t.users[0].name))},directives:[v.a,s.l,s.m,v.d,h.a,v.c],styles:[""],changeDetection:0}),e})();var U=n("gJPw"),C=n("xVbo"),x=n("YtkY"),$=n("C05f");const z="chatUser";let T=(()=>{class e{constructor(){this.currentUser=new $.a(null),this.currentUser$=this.currentUser.asObservable();const e=JSON.parse(window.sessionStorage.getItem(z));e&&this.currentUser.next(e)}getCurrentUserName(){return JSON.parse(window.sessionStorage.getItem(z)).name}enterChat(e){this.currentUser.next({name:e}),window.sessionStorage.setItem(z,JSON.stringify({name:e}))}exitChat(){this.currentUser.next(null),this.currentUser.complete(),window.sessionStorage.removeItem(z)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Gb({token:e,factory:e.\u0275fac}),e})();var j=n("vobO");let F=(()=>{class e{constructor(e,t,n){this.dataService=e,this.sessionService=t,this._http=n,this.chatMessages$=this.dataService.stream$.pipe(Object(C.a)(e=>"messages"===e.event),Object(x.a)(e=>e.data)),this.chatUsers$=this.dataService.stream$.pipe(Object(C.a)(e=>"users"===e.event),Object(x.a)(e=>e.data)),this.connection$=this.dataService.connection$,this.connectionOptions={reconnect:!1,queryParams:""}}connectSocket(){const e=this.sessionService.getCurrentUserName();this.connectionOptions.queryParams="chatUser="+e,this.dataService.connect(this.connectionOptions)}disconnectSocket(){this.dataService.disconnect()}sendEvent(e){this.dataService.sendMessage(e)}sendChatMessage(e){this.dataService.sendMessage("chatMessage",e)}getUsers(){return this._http.get("/api/users")}}return e.\u0275fac=function(t){return new(t||e)(a.Tb(U.b),a.Tb(T),a.Tb(j.a))},e.\u0275prov=a.Gb({token:e,factory:e.\u0275fac}),e})();var E=n("ROBh"),L=n("J+dc"),N=n("TLy2");let X=(()=>{class e{constructor(e,t){this.router=e,this.sessionService=t}canActivate(e,t){return this.sessionService.currentUser$.pipe(Object(L.a)(1),Object(N.a)(e=>e?Object(E.a)(!0):(this.router.navigate(["/chat/enter"]),Object(E.a)(!1))))}}return e.\u0275fac=function(t){return new(t||e)(a.Tb(r.b),a.Tb(T))},e.\u0275prov=a.Gb({token:e,factory:e.\u0275fac}),e})();const A=function(){return{standalone:!0}};let J=(()=>{class e{constructor(e,t){this.sessionService=e,this.router=t,this.username=""}ngOnInit(){}sendUserInfo(){this.sessionService.enterChat(this.username),this.username="",this.router.navigate(["/chat/room"])}}return e.\u0275fac=function(t){return new(t||e)(a.Kb(T),a.Kb(r.b))},e.\u0275cmp=a.Eb({type:e,selectors:[["test-chat-chat-login"]],decls:15,vars:3,consts:[[1,"chat-login-card"],["mat-card-avatar","",1,"example-header-image"],["appearance","fill"],["flex","","matInput","","placeholder","Message","name","username","required","","minlength","3",3,"ngModel","ngModelOptions","ngModelChange"],["mat-button","","mat-stroked-button","",3,"click"]],template:function(e,t){1&e&&(a.Pb(0,"mat-card",0),a.Pb(1,"mat-card-header"),a.Lb(2,"div",1),a.Pb(3,"mat-card-title"),a.uc(4,"Shiba Inu"),a.Ob(),a.Pb(5,"mat-card-subtitle"),a.uc(6,"Dog Breed"),a.Ob(),a.Ob(),a.Pb(7,"mat-card-content"),a.Pb(8,"mat-form-field",2),a.Pb(9,"mat-label"),a.uc(10,"Input"),a.Ob(),a.Pb(11,"input",3),a.Xb("ngModelChange",(function(e){return t.username=e})),a.Ob(),a.Ob(),a.Ob(),a.Pb(12,"mat-card-actions"),a.Pb(13,"button",4),a.Xb("click",(function(){return t.sendUserInfo()})),a.uc(14," ENTER "),a.Ob(),a.Ob(),a.Ob()),2&e&&(a.zb(11),a.fc("ngModel",t.username)("ngModelOptions",a.hc(2,A)))},directives:[i.a,i.e,i.c,i.h,i.g,i.d,o.a,o.d,u.a,l.a,l.l,l.d,l.g,l.j,i.b,b.a],styles:[""]}),e})();var D=n("lQ7A");const H=[{path:"room",component:(()=>{class e{constructor(e,t){this.chatService=e,this.sessionService=t,this.currentUser=null,this.currentUserName="",this.users$=this.chatService.chatUsers$,this.messages$=this.chatService.chatMessages$,this.connection$=this.chatService.connection$,this.messageInput=""}ngOnInit(){this.sessionService.currentUser$.subscribe(e=>this.currentUser=e),this.chatService.connectSocket(),this.chatService.sendEvent("chat"),this.chatService.sendEvent("users")}userNameClicked(e){const t="@"+e.name;this.messageInput&&this.messageInput.includes(t)||(this.messageInput=this.messageInput+t+" ")}sendMessage(e){this.chatService.sendChatMessage({message:e,user:this.currentUser}),this.messageInput=null}}return e.\u0275fac=function(t){return new(t||e)(a.Kb(F),a.Kb(T))},e.\u0275cmp=a.Eb({type:e,selectors:[["ng-component"]],decls:10,vars:8,consts:[["fullscreen",""],["opened","","mode","side","position","end",1,"chat-sidenav"],["sidenav",""],[3,"currentUser","users","userClicked"],["layout","column","layout-fill","",1,"chat-main"],[3,"messages"],[3,"text","send"]],template:function(e,t){1&e&&(a.Pb(0,"mat-sidenav-container",0),a.Pb(1,"mat-sidenav",1,2),a.Pb(3,"chat-users",3),a.Xb("userClicked",(function(e){return t.userNameClicked(e)})),a.ac(4,"async"),a.Ob(),a.Ob(),a.Pb(5,"mat-sidenav-content"),a.Pb(6,"div",4),a.Lb(7,"chat-list",5),a.ac(8,"async"),a.Pb(9,"chat-form",6),a.Xb("send",(function(e){return t.sendMessage(e)})),a.Ob(),a.Ob(),a.Ob(),a.Ob()),2&e&&(a.zb(3),a.fc("currentUser",t.currentUser)("users",a.bc(4,4,t.users$)),a.zb(4),a.fc("messages",a.bc(8,6,t.messages$)),a.zb(2),a.fc("text",t.messageInput))},directives:[D.b,D.a,M,D.c,S,f],pipes:[s.b],styles:[".chat-main{min-height:100%;display:flex;flex-direction:column;align-items:stretch}.chat-main chat-list{flex-grow:1}.chat-main chat-form{flex-shrink:0}"],encapsulation:2}),e})(),canActivate:[X]},{path:"enter",component:J},{path:"",redirectTo:"room"}];let Z=(()=>{class e{}return e.\u0275mod=a.Ib({type:e}),e.\u0275inj=a.Hb({factory:function(t){return new(t||e)},imports:[[r.d.forChild(H)]]}),e})(),q=(()=>{class e{}return e.\u0275mod=a.Ib({type:e}),e.\u0275inj=a.Hb({factory:function(t){return new(t||e)},providers:[F,X,T],imports:[[s.c,Z,c.a]]}),e})(),K=(()=>{class e{}return e.\u0275mod=a.Ib({type:e}),e.\u0275inj=a.Hb({factory:function(t){return new(t||e)},imports:[[q]]}),e})()}}]);